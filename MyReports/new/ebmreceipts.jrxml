<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.21.1.final using JasperReports Library version 6.21.0-4f56c4f36cd19e17675219a9ac4692d5f0f13b06  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ebmm" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="97e8aa17-6736-4900-a44f-07b8e2a3a719">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="ffars"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="217"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="772"/>
	<parameter name="logo_source" class="java.lang.String">
		<parameterDescription><![CDATA[National Logo Source]]></parameterDescription>
	</parameter>
	<parameter name="location_id" class="java.lang.Integer">
		<parameterDescription><![CDATA[Facility ID]]></parameterDescription>
	</parameter>
	<parameter name="start_date" class="java.sql.Date">
		<parameterDescription><![CDATA[Start Date]]></parameterDescription>
	</parameter>
	<parameter name="end_date" class="java.sql.Date">
		<parameterDescription><![CDATA[End Date]]></parameterDescription>
	</parameter>
	<queryString language="SQL">
		<![CDATA[SELECT wv.rname      as region,
       wv.cname      as council_name,
       INITCAP( f.name )     as facility_name,
       f.code        as facility_code,
       ft.name       as facility_type_name,
       fs.description       as fundsourcename,
       fs.code       as fundsourcecode,
       month,
       fac.name as accountname,
       receipt_number,
       fac.number  as accountnumber,
       amount

FROM (
         SELECT geg.facility_id,
                ga.fund_code ,
                ga.gfs_code,
                to_char(geg.apply_date, 'Mon-YYYY')  as month,
                r.receipt_number,
                ca.bank_account_id as facility_account_id,
                sum(ge.cr_amount - ge.dr_amount)  as amount
         FROM gl_entries ge
                  join gl_entry_groups geg on geg.id = ge.gl_entry_group_id
                  join gl_accounts ga on ga.code = ge.account
                  join cash_books ca on ca.gl_entry_group_id = geg.id
                  join receipts r on r.id = geg.transaction_id
                  JOIN facility_ward_view wv ON wv.id = geg.facility_id
                  where
                 ga.gl_account_type = 'REVENUE' AND geg.transaction_type = 'App\Models\Receipt'
           AND geg.financial_year_id = 1
           AND geg.apply_date between $P{start_date}
             AND $P{end_date}
           AND ga.fund_code IN ('20J','20K','20F','20Z')
           AND (wv.cid  = $P{location_id} or wv.rid = $P{location_id} or  1 = $P{location_id})
         
         GROUP BY r.receipt_number, ga.fund_code, geg.facility_id, ga.gfs_code, to_char(geg.apply_date, 'Mon-YYYY'), r.receipt_number, ca.bank_account_id, ca.bank_account_id
     ) data
         JOIN facilities f ON f.id = data.facility_id
         JOIN bank_accounts fac ON fac.id = data.facility_account_id
         JOIN facility_ward_view wv ON wv.id = f.id
         JOIN facility_types ft ON ft.id = f.facility_type_id
         JOIN funding_sources fs ON fs.code = data.fund_code
where f.deleted_at is null
  AND f.facility_type_id IN (8,11)
order by month;]]>
	</queryString>
	<field name="region" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="region"/>
		<property name="com.jaspersoft.studio.field.label" value="region"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="facility_ward_view"/>
	</field>
	<field name="council_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="council_name"/>
		<property name="com.jaspersoft.studio.field.label" value="council_name"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="facility_ward_view"/>
	</field>
	<field name="facility_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="facility_name"/>
		<property name="com.jaspersoft.studio.field.label" value="facility_name"/>
	</field>
	<field name="facility_code" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="facility_code"/>
		<property name="com.jaspersoft.studio.field.label" value="facility_code"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="facilities"/>
	</field>
	<field name="facility_type_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="facility_type_name"/>
		<property name="com.jaspersoft.studio.field.label" value="facility_type_name"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="facility_types"/>
	</field>
	<field name="fundsourcename" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="fundsourcename"/>
		<property name="com.jaspersoft.studio.field.label" value="fundsourcename"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="funding_sources"/>
	</field>
	<field name="fundsourcecode" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="fundsourcecode"/>
		<property name="com.jaspersoft.studio.field.label" value="fundsourcecode"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="funding_sources"/>
	</field>
	<field name="month" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="month"/>
		<property name="com.jaspersoft.studio.field.label" value="month"/>
	</field>
	<field name="accountname" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="accountname"/>
		<property name="com.jaspersoft.studio.field.label" value="accountname"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="bank_accounts"/>
	</field>
	<field name="receipt_number" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="receipt_number"/>
		<property name="com.jaspersoft.studio.field.label" value="receipt_number"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="receipts"/>
	</field>
	<field name="accountnumber" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="accountnumber"/>
		<property name="com.jaspersoft.studio.field.label" value="accountnumber"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="bank_accounts"/>
	</field>
	<field name="amount" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.name" value="amount"/>
		<property name="com.jaspersoft.studio.field.label" value="amount"/>
	</field>
	<group name="region">
		<groupExpression><![CDATA[$F{region}]]></groupExpression>
	</group>
	<group name="council">
		<groupExpression><![CDATA[$F{council_name}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="107" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="83" width="800" height="17" uuid="be13a761-d361-4439-a971-45f8453be311">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<box rightPadding="3"/>
				<textElement textAlignment="Center">
					<font fontName="Roboto" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[ EBM Monthly Report]]></text>
			</staticText>
			<image hAlign="Center" onErrorType="Blank">
				<reportElement x="358" y="-20" width="86" height="75" uuid="04e33450-57de-4805-afce-f156cb86764c"/>
				<imageExpression><![CDATA["repo:/Images/logo"]]></imageExpression>
			</image>
			<staticText>
				<reportElement x="316" y="57" width="170" height="10" uuid="dd18b05c-f827-4cff-9b70-b12050b7424b"/>
				<textElement textAlignment="Center">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[United Republic Of Tanzania]]></text>
			</staticText>
			<staticText>
				<reportElement x="277" y="68" width="249" height="10" uuid="a0f2a847-6eff-4100-b77a-119c9b7db345"/>
				<textElement textAlignment="Center">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[President Office Reginal Administration and Local Goverment]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="35" splitType="Stretch">
			<textField pattern="">
				<reportElement x="0" y="1" width="800" height="18" backcolor="#F2F2F2" uuid="6cbdd0cb-dff9-451d-b67d-4e6fa1c4d44b"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Double"/>
					<topPen lineWidth="1.0" lineStyle="Double" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Double" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="Roboto" isBold="true" isUnderline="false"/>
					<paragraph lineSpacing="Double"/>
				</textElement>
				<textFieldExpression><![CDATA["From " + $P{start_date} + "  TO "  + $P{end_date}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="16" splitType="Stretch">
			<staticText>
				<reportElement x="200" y="0" width="60" height="16" uuid="57a35156-61c7-4b47-8679-5f55118b2937"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Code]]></text>
			</staticText>
			<staticText>
				<reportElement x="440" y="0" width="60" height="16" uuid="28900458-20af-4313-b745-fd98f5230620"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Month]]></text>
			</staticText>
			<staticText>
				<reportElement x="620" y="0" width="80" height="16" uuid="4d5220a8-7d3e-4eeb-a0b1-26cd60e3e1b7"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Acc Number]]></text>
			</staticText>
			<staticText>
				<reportElement x="70" y="0" width="70" height="16" uuid="edec070e-2c48-44ac-b1ce-be55cf429720"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[LGA]]></text>
			</staticText>
			<staticText>
				<reportElement x="340" y="0" width="100" height="16" uuid="81a7ecb6-a241-44da-8461-4fdc5b8e4e73"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Fund Name]]></text>
			</staticText>
			<staticText>
				<reportElement x="260" y="0" width="80" height="16" uuid="695a52cf-389c-4d97-8524-a7362894239b"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Facility Type]]></text>
			</staticText>
			<staticText>
				<reportElement x="700" y="0" width="100" height="16" uuid="5929b5d9-b262-440b-a5e9-0e1873f3a195"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Amount]]></text>
			</staticText>
			<staticText>
				<reportElement x="140" y="0" width="60" height="16" uuid="a110fb4d-b045-4c36-86bd-2d74ef3e010d">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Facility]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="0" width="70" height="16" uuid="a75a254f-72ad-462a-9e14-26b6f545f691"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Region]]></text>
			</staticText>
			<staticText>
				<reportElement x="500" y="0" width="120" height="16" uuid="e484a355-fc0c-4d19-af29-7df18b9e1468"/>
				<box leftPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement>
					<font fontName="Roboto" isBold="true"/>
				</textElement>
				<text><![CDATA[Acc Name]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="200" y="0" width="60" height="15" uuid="d86b1bc2-095a-4b59-a1a8-7c8163d2b525">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{facility_code}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="260" y="0" width="80" height="15" uuid="f8bfedba-00c3-47cc-b04b-4c04c95139f3"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{facility_type_name}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="440" y="0" width="60" height="15" uuid="4390cbb9-085f-4a3e-9f20-29b4413ab6fd"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{month}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="620" y="0" width="80" height="15" uuid="b9657f0b-8453-48f7-9201-200d39d434a0"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{accountnumber}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="70" y="0" width="70" height="15" uuid="f88465d6-f800-45ad-81e9-bda54edc6836"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{council_name}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="340" y="0" width="100" height="15" uuid="59851f89-7e05-467c-9908-e1029747aba2"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fundsourcename}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight" pattern="#,##0.00">
				<reportElement stretchType="RelativeToTallestObject" x="700" y="0" width="100" height="15" uuid="58364aeb-a6c8-4686-a4d4-f0a53f105e8d"/>
				<box rightPadding="5">
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Roboto" size="8" isBold="true"/>
					<paragraph lineSpacing="AtLeast" leftIndent="0" rightIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{amount}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="140" y="0" width="60" height="15" uuid="92aa3a9e-0727-4ee2-aee5-1cf9d85a2249"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{facility_name}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="0" y="0" width="70" height="15" uuid="6f5f1543-6854-48e7-9bb2-1f53fb36a1d5"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{region}]]></textFieldExpression>
			</textField>
			<textField textAdjust="StretchHeight">
				<reportElement stretchType="RelativeToTallestObject" x="500" y="0" width="120" height="15" uuid="c5f3a726-016b-4da4-b2b4-6b0fa4d86d3d"/>
				<box>
					<pen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Roboto" size="8"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{accountname}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="9" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="15" splitType="Stretch">
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<textField>
				<reportElement x="603" y="0" width="97" height="15" uuid="99341e17-cb6c-4efb-a9d0-3881f2d73641">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Right">
					<font fontName="Roboto" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Page " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="703" y="0" width="97" height="15" uuid="25ebf405-a45f-49c0-b9b6-ac05e330e027"/>
				<textElement textAlignment="Left">
					<font fontName="Roboto" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" of " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM dd, yyyy">
				<reportElement x="0" y="0" width="129" height="15" uuid="32e6aaec-162b-45a2-aa10-b6e11d127f5c">
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="10" splitType="Stretch"/>
	</summary>
</jasperReport>
